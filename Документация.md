
# Документация проекта: Генератор маршрутных карт

## Описание

Этот проект представляет собой приложение для генерации маршрутных карт в формате PowerPoint. Каждая карта содержит уникальный номер и QR-код, который также соответствует этому номеру. Программа поддерживает генерацию как одного, так и нескольких бланков одновременно.

## Основные компоненты

### 1. `generate_form_pptx.py`

Этот файл содержит основную логику приложения, включая функции для работы с базой данных, генерации QR-кодов и создания презентаций PowerPoint.

#### Основные функции

- **`create_database()`**: Создает базу данных SQLite, если она не существует. База данных используется для хранения информации о созданных маршрутных картах.

- **`save_to_database(form_number, file_path)`**: Сохраняет информацию о созданной маршрутной карте в базу данных. Использует контекстный менеджер для безопасной работы с базой данных.

- **`check_duplicate_form_number(form_number)`**: Проверяет, существует ли уже маршрутная карта с данным номером в базе данных.

- **`generate_form_with_qr(template_path, output_path, form_number)`**: Генерирует маршрутную карту с QR-кодом и номером. QR-код размещается на уровне текста "МАРШРУТНАЯ КАРТА", если он найден на слайде.

- **`generate_multiple_forms(template_path, start_number, count)`**: Генерирует несколько маршрутных карт, начиная с указанного номера. Проверяет наличие дубликатов перед генерацией.

### 2. Пользовательский интерфейс

Программа использует Kivy для создания графического интерфейса, который позволяет пользователю:

- Выбирать режим генерации (один или несколько бланков).
- Вводить номер бланка и количество бланков для генерации.
- Запускать процесс генерации и получать уведомления об успехе или ошибках.

#### Основные классы

- **`FormGeneratorUI`**: Основной класс интерфейса, который управляет элементами управления и взаимодействием с пользователем.

- **`InfoPopup`**: Класс для отображения всплывающих окон с информацией об ошибках или успехе.

- **`FormGeneratorApp`**: Класс приложения Kivy, который инициализирует и запускает интерфейс.

## Установка и запуск

1. Установите необходимые зависимости:
   ```bash
   pip install python-pptx qrcode kivy
   ```

2. Запустите приложение:
   ```bash
   python generate_form_pptx.py
   ```

## Требования

- Python 3.x
- Библиотеки: `python-pptx`, `qrcode`, `kivy`
- Шаблон PowerPoint (`ШАБЛОН.pptx`) должен находиться в корневой директории проекта.

## Примечания

- Убедитесь, что файл шаблона PowerPoint (`ШАБЛОН.pptx`) доступен в директории проекта перед запуском генерации.
- Программа создает и использует базу данных `маршрутные_карты.db` для хранения информации о созданных бланках.

## Лицензия

Этот проект распространяется под лицензией MIT. Подробности см. в файле LICENSE.
